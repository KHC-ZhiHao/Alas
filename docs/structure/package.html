<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Package &amp; Rule &amp; Locale | ALAS Guide</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" href="/Alas/images/logo.ico">
    <meta name="description" content="資源狀態管理工具">
    
    <link rel="preload" href="/Alas/assets/css/0.styles.12958354.css" as="style"><link rel="preload" href="/Alas/assets/js/app.b9739156.js" as="script"><link rel="preload" href="/Alas/assets/js/2.c61470ba.js" as="script"><link rel="preload" href="/Alas/assets/js/21.024ae460.js" as="script"><link rel="prefetch" href="/Alas/assets/js/10.5e99f11e.js"><link rel="prefetch" href="/Alas/assets/js/11.c2883706.js"><link rel="prefetch" href="/Alas/assets/js/12.aa4a0dd3.js"><link rel="prefetch" href="/Alas/assets/js/13.2d444647.js"><link rel="prefetch" href="/Alas/assets/js/14.86b22aa1.js"><link rel="prefetch" href="/Alas/assets/js/15.b907bc16.js"><link rel="prefetch" href="/Alas/assets/js/16.b38c20e9.js"><link rel="prefetch" href="/Alas/assets/js/17.fceace52.js"><link rel="prefetch" href="/Alas/assets/js/18.e10dcbc8.js"><link rel="prefetch" href="/Alas/assets/js/19.d6a487c3.js"><link rel="prefetch" href="/Alas/assets/js/20.cdde1153.js"><link rel="prefetch" href="/Alas/assets/js/22.084beb2b.js"><link rel="prefetch" href="/Alas/assets/js/23.0aeebcf3.js"><link rel="prefetch" href="/Alas/assets/js/24.4a347d43.js"><link rel="prefetch" href="/Alas/assets/js/3.b4237e0f.js"><link rel="prefetch" href="/Alas/assets/js/4.1d6ef5fb.js"><link rel="prefetch" href="/Alas/assets/js/5.ca78938a.js"><link rel="prefetch" href="/Alas/assets/js/6.bff73d77.js"><link rel="prefetch" href="/Alas/assets/js/7.0953f092.js"><link rel="prefetch" href="/Alas/assets/js/8.747dab6a.js"><link rel="prefetch" href="/Alas/assets/js/9.2496527b.js">
    <link rel="stylesheet" href="/Alas/assets/css/0.styles.12958354.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Alas/" class="home-link router-link-active"><!----> <span class="site-name">ALAS Guide</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Alas/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/Alas/structure/" class="nav-link router-link-active">
  結構與操作
</a></div><div class="nav-item"><a href="https://github.com/KHC-ZhiHao/Alas" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Alas/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/Alas/structure/" class="nav-link router-link-active">
  結構與操作
</a></div><div class="nav-item"><a href="https://github.com/KHC-ZhiHao/Alas" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Alas/structure/" aria-current="page" class="sidebar-link">結構</a></li><li><a href="/Alas/structure/core.html" class="sidebar-link">Core</a></li><li><a href="/Alas/structure/container.html" class="sidebar-link">Container</a></li><li><a href="/Alas/structure/model.html" class="sidebar-link">Model</a></li><li><a href="/Alas/structure/list.html" class="sidebar-link">List</a></li><li><a href="/Alas/structure/dictionary.html" class="sidebar-link">Dictionary</a></li><li><a href="/Alas/structure/status.html" class="sidebar-link">Status</a></li><li><a href="/Alas/structure/loader.html" class="sidebar-link">Loader</a></li><li><a href="/Alas/structure/package.html" aria-current="page" class="active sidebar-link">Package &amp; Rule &amp; Locale</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Alas/structure/package.html#types" class="sidebar-link">Types</a></li><li class="sidebar-sub-header"><a href="/Alas/structure/package.html#rule" class="sidebar-link">Rule</a></li><li class="sidebar-sub-header"><a href="/Alas/structure/package.html#locale" class="sidebar-link">Locale</a></li><li class="sidebar-sub-header"><a href="/Alas/structure/package.html#container" class="sidebar-link">Container</a></li></ul></li><li><a href="/Alas/structure/utils.html" class="sidebar-link">Utils</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="package-rule-locale"><a href="#package-rule-locale" class="header-anchor">#</a> Package &amp; Rule &amp; Locale</h1> <p>是一種封裝驗證規則與語系的資料結構，可以獨立宣告更頂層的驗證規則與語系訊息。</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p><code>name</code> 參數是唯一值，註冊在後必須透過 <code>#{name}.{target}</code> 去獲得指定的規則或是訊息，務必注意到命名的衝突。</p></div> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> alas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Alas</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    packages<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'my'</span><span class="token punctuation">,</span>
            rules<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token function">number</span><span class="token punctuation">(</span>model<span class="token operator">:</span> Model<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> <span class="token keyword">type</span> <span class="token operator">=</span> model<span class="token punctuation">.</span>$utils<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
                    <span class="token comment">// 驗證結果可以透過 $meg 來返回不同的錯誤訊息</span>
                    <span class="token keyword">return</span> <span class="token keyword">type</span> <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> model<span class="token punctuation">.</span><span class="token function">$meg</span><span class="token punctuation">(</span><span class="token string">'#my.notNumber'</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            locales<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string">'zh-tw'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token string">'notNumber'</span><span class="token operator">:</span> <span class="token string">'不是數字'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="types"><a href="#types" class="header-anchor">#</a> Types</h2> <p><code>PackageOptions</code> 是輔助你定義 package 的好幫手。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PackageOptions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'alas'</span>
<span class="token keyword">const</span> myPackage<span class="token operator">:</span> PackageOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'my'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="rule"><a href="#rule" class="header-anchor">#</a> Rule</h2> <p>規則是一種驗證方法，將值傳給一個 function，並回傳 <code>true</code> 或是 <code>string</code>(錯誤訊息)。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">number</span><span class="token punctuation">(</span>model<span class="token operator">:</span> Model<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">type</span> <span class="token operator">=</span> model<span class="token punctuation">.</span>$utils<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">type</span> <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token string">'Value must be a number.'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="params"><a href="#params" class="header-anchor">#</a> Params</h3> <p>Rule 可以接受簡單的參數來賦予更靈活的宣告方法，加入參數的方法是透過 | 符號<strong>切割</strong>參數的鍵值，使用 : 符號<strong>定義</strong>指定值，例如：<code>max|value:20</code>，獲取的對象將傳遞給第二個參數。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">max</span><span class="token punctuation">(</span>model<span class="token operator">:</span> Model<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> params<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> value <span class="token operator">&gt;</span> <span class="token function">Number</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Value more then </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="所有的方法都會忽略空值"><a href="#所有的方法都會忽略空值" class="header-anchor">#</a> 所有的方法都會忽略空值</h3> <p>空值 ( null or undefined ) 不做驗證，可以用以下結構使空值也做檢查。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> packageOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">{</span>
        max<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>model<span class="token operator">:</span> Model<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            required<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 透過 required 使驗證必須不計空值</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="locale"><a href="#locale" class="header-anchor">#</a> Locale</h2> <p>身為 view model 的特性，我們必須呈現將訊息呈現給各種語言的客戶，但由於 Alas 具有封裝性，因此本身也必須要有語系的系統：</p> <h3 id="params-2"><a href="#params-2" class="header-anchor">#</a> Params</h3> <p>輸出的 message 允許加入動態元素，使用<code>{}</code>符號作為更動目標。</p> <div class="custom-block tip"><p class="custom-block-title">提醒</p> <p>注意 {} 不能有空格</p></div> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> packageOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'my'</span><span class="token punctuation">,</span>
    locales<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">'en-us'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'age'</span><span class="token operator">:</span> <span class="token string">'{value} years old.'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'zh-tw'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'age'</span><span class="token operator">:</span> <span class="token string">'年齡為{value}歲'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="切換語系"><a href="#切換語系" class="header-anchor">#</a> 切換語系</h3> <p>語系默認為 <code>en-us</code>，可以使用以下方法更換顯示狀態。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>alas<span class="token punctuation">.</span><span class="token function">meg</span><span class="token punctuation">(</span><span class="token string">'#my.age'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 20 years old.</span>

<span class="token comment">// 切換成中文</span>
alas<span class="token punctuation">.</span><span class="token function">setLocale</span><span class="token punctuation">(</span><span class="token string">'zh-tw'</span><span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>alas<span class="token punctuation">.</span><span class="token function">meg</span><span class="token punctuation">(</span><span class="token string">'#my.age'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 年齡為20歲.</span>

<span class="token comment">// 未定義情境下，會顯示英文</span>
alas<span class="token punctuation">.</span><span class="token function">setLocale</span><span class="token punctuation">(</span><span class="token string">'zh-cn'</span><span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>alas<span class="token punctuation">.</span><span class="token function">meg</span><span class="token punctuation">(</span><span class="token string">'#my.age'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 20 years old.</span>

<span class="token comment">// 連英文也未定義情境下，回傳key值</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>alas<span class="token punctuation">.</span><span class="token function">meg</span><span class="token punctuation">(</span><span class="token string">'#my.hw'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// #my.hw</span>
</code></pre></div><h3 id="ms"><a href="#ms" class="header-anchor">#</a> MS</h3> <p>MS 是一個 <code>MetalSheep</code> 官方配件包，本身已經註冊在 Core 內不需要額外引用，你可以參考<a href="https://github.com/KHC-ZhiHao/Alas/blob/master/core/ms-package.ts" target="_blank" rel="noopener noreferrer">原始碼<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>來了解應用，而這個套件包佔據了 <code>ms</code> 關鍵名稱。</p> <h3 id="擴充語系"><a href="#擴充語系" class="header-anchor">#</a> 擴充語系</h3> <p>MS 本身提供了 <code>en-us</code> 與 <code>zh-tw</code> 兩個語系，你可以從以下方法訪問到該 Package 物件，可用於擴充語系：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> Alas <span class="token keyword">from</span> <span class="token string">'alas'</span>
Alas<span class="token punctuation">.</span>MsPackage<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token string">'ja'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'required'</span><span class="token operator">:</span> <span class="token string">'必須'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="container"><a href="#container" class="header-anchor">#</a> Container</h2> <p>container 本身的 model 如果要去獲取規則或是訊息是可以忽視掉前贅命名的，但如果跨 <code>container</code> 可以透過 <code>${containerName}.{target}</code> 去獲得，但我們不推薦就是了。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Alas/structure/loader.html" class="prev">
        Loader
      </a></span> <span class="next"><a href="/Alas/structure/utils.html">
        Utils
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Alas/assets/js/app.b9739156.js" defer></script><script src="/Alas/assets/js/2.c61470ba.js" defer></script><script src="/Alas/assets/js/21.024ae460.js" defer></script>
  </body>
</html>
